<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="bqns">
	<resultMap  id="boardqna" type="bqb">
		<result property="qno" column="qno"/>
		<result property="qsub" column="qsub"/>
		<result property="qcont" column="qcont"/>
		<result property="qreg" column="qreg"/>
		<result property="qdel" column="qdel"/>
		<result property="qfile" column="qfile"/>
		<result property="qreadcount" column="qreadcount"/>
	</resultMap>
	
	<select id="list" parameterType="bqb" resultMap="boardqna">
 		select * from (select a.*, rowNum rn from(
 			select * from qboard
			<where>
			<if test="keyword != null and search != 'subcon'">
				${search} like '%'||#{keyword}||'%'
			</if>
			<if test="keyword != null and search == 'subcon'">
				subject like '%'||#{keyword}||'%' or
				content like '%'||#{keyword}||'%'
			</if>
		</where>			
			 order by qno desc) a )
			where rn between #{startRow} and #{endRow}
	</select>
	
	<select id="getTotal" parameterType="bqb" resultType="int">
		select count(*) from qboard 
		<where>
			<if test="keyword != null and search !='subcon'">
				${search} like '%'||#{keyword}||'%'
			</if>
			<if test="keyword != null and search=='subcon'">
				subject like '%'||#{keyword}||'%' or
				content like '%'||#{keyword}||'%'
			</if>
		</where>
</select>
</mapper>